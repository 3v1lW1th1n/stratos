<app-meta-card *ngIf="serviceInstanceEntity" class="app-service-card" [actionMenu]="cardMenu"
  [entityConfig]="entityConfig">
  <app-meta-card-title>
    <app-multiline-title class="service-instance-card__title">{{ serviceInstanceEntity.entity.name }}
    </app-multiline-title>
  </app-meta-card-title>
  <app-meta-card-item>
    <app-meta-card-key>{{cfOrgSpace.getLabel() | async}}</app-meta-card-key>
    <app-meta-card-value>
      <app-cf-org-space-links [service]="cfOrgSpace" [spaceBreadCrumbs]="getSpaceBreadcrumbs()">
      </app-cf-org-space-links>
    </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Service</app-meta-card-key>
    <app-meta-card-value>{{ getServiceName() }} </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Service Plan</app-meta-card-key>
    <app-meta-card-value>{{ serviceInstanceEntity.entity.service_plan?.entity.name}} </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Service Broker</app-meta-card-key>
    <app-meta-card-value>{{(serviceBroker$ | async)?.entity.name }} </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Applications Attached</app-meta-card-key>
    <app-meta-card-value>{{ serviceInstanceEntity.entity.service_bindings?.length }} </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item *ngIf="serviceInstanceEntity.entity.last_operation as lo">
    <app-meta-card-key>Last Operation</app-meta-card-key>
    <app-meta-card-value>
      <div class="service-instance-card__op">
        <div class="service-instance-card__op--row1">
          {{lo.type | titlecase }}
          <app-boolean-indicator *ngIf="lo.state==='in progress'; else normalIndicator"
            class="service-instance-card__op--item" [isTrue]="true" type="progress-progress" [subtle]="false"
            [showText]="false"></app-boolean-indicator>
          <ng-template #normalIndicator>
            <app-boolean-indicator class="service-instance-card__op--item" [isTrue]="lo.state==='succeeded'"
              type="yes-no" [subtle]="false" [showText]="false">
            </app-boolean-indicator>
          </ng-template>
          <span class="service-instance-card__op--item" *ngIf="!!lo.description">({{lo.description}}) </span>
        </div>
        <div class="service-instance-card__op--row2">{{ lo.updated_at | date:'medium' }}</div>
      </div>
    </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Dashboard</app-meta-card-key>
    <app-meta-card-value>
      <div *ngIf="!!serviceInstanceEntity.entity.dashboard_url ; then dashboardUrl; else none"></div>
      <ng-template #dashboardUrl>
        <div class="service-instance-card__link">
          <a class="service-instance-card__icon-link" [href]="serviceInstanceEntity.entity.dashboard_url"
            target="_blank" appClickStopPropagation>
            <mat-icon>launch</mat-icon>
          </a>
          <a [href]="serviceInstanceEntity.entity.dashboard_url" target="_blank" appClickStopPropagation>View</a>
        </div>
      </ng-template>
      <ng-template #none>None</ng-template>
    </app-meta-card-value>
  </app-meta-card-item>
  <app-meta-card-item>
    <app-meta-card-key>Tags</app-meta-card-key>
    <app-meta-card-value>
      <app-chips [chips]="serviceInstanceTags"></app-chips>
    </app-meta-card-value>
  </app-meta-card-item>
</app-meta-card>